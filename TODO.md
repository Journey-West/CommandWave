# TODO: Refactor & Cleanup Tasks for CommandWave

This file lists detailed tasks for improving modularity, removing legacy code, and streamlining the repository.

1. **Remove or Repurpose `core/config.py`**
   - **Description**: `core/config.py` is currently an empty scaffold. Either implement real configuration management (environment variables, feature flags, secrets) or delete this file to reduce clutter.
   - **Why**: Eliminates dead code and clarifies where configuration should live.

2. **Refactor `main.py`**
   - **Description**: The entry point `main.py` is ~1000 lines long and mixes CLI parsing, server setup, terminal management, and helper routes.
   - **Subtasks**:
     - Extract CLI and argument parsing into `cli.py`.
     - Move ttyd/tmux lifecycle functions (`start_ttyd_process`, `kill_terminal`, etc.) into a `terminal_manager.py`.
     - Retain only server initialization in `main.py` (Flask, SocketIO setup).
     - Move any remaining HTTP endpoints in `main.py` into corresponding Blueprints under `routes/`.
   - **Why**: Improves readability, testability, and separation of concerns.

3. **Migrate endpoints out of `main.py` into Blueprints**
   - **Description**: Some HTTP routes (healthcheck, playbook file serve, etc.) live in `main.py`.
   - **Why**: Ensures all route logic is housed in `routes/`, maintaining a consistent project structure.

4. **Refactor or Remove `static/js/script.js`**
   - **Description**: Legacy bundle with outdated UI logic; modern code is in ES6 modules (`main.js`, `ui/`, `api/`).
   - **Why**: Eliminates duplicate or stale code and embraces a modular front-end structure.

5. **Consolidate `apply_theme_*.sh` scripts**
   - **Description**: Two nearly identical shell scripts to apply tmux themes on ports 7683 and 7684.
   - **Why**: Merge into a single parameterized script or integrate into a Python CLI/UI toggle to reduce duplication.

6. **Archive or Remove `ffuf_results.json`**
   - **Description**: Sample output from the `ffuf` tool used for security testing examples.
   - **Why**: Samples should live in an `examples/` or `tests/fixtures/` folder or be removed if not used.

7. **Deduplicate Playbook Files**
   - **Description**: Two files in `playbooks/` differ only by a typo (`ExeternalActive_â€¦`).
   - **Why**: Merge or delete duplicate files to avoid confusion and maintain a clean playbooks directory.

8. **Cleanup `__pycache__` directories**
   - **Description**: Auto-generated bytecode caches scattered in `core/`, `routes/`, etc.
   - **Why**: Add `__pycache__/` to `.gitignore` and remove them from version control to keep the repo clean.

9. **Extract `docs/` Jekyll site into its own repo/branch**
   - **Description**: The `docs/` folder contains compiled site assets, CSS, JS, and partials for GitHub Pages.
   - **Why**: Moving documentation to a dedicated `gh-pages` branch or separate repo reduces codebase clutter and separation of docs vs. code.

10. **Consolidate Theme CSS Files**
    - **Description**: Multiple nearly identical theme files in both `docs/css/themes/` and `static/css/themes/`.
    - **Why**: Use CSS variables or preprocessing to generate themes from shared base, reducing duplication.

11. **Audit `static/css/components` & `static/js/ui`**
    - **Description**: Ensure every UI component has paired CSS and JS; remove any unused styles or scripts.
    - **Why**: Keeps front-end code lean and maintainable.

12. **Move Sample Data from `data/` to `tests/fixtures/`**
    - **Description**: The `data/` directory holds sample notes and variables used for demos or testing.
    - **Why**: Distinguishes test fixtures from production data, aiding clarity and environment isolation.
